# TGondii

This Python code was used to generate figures for the manuscript titled "The latent stage of Toxoplasma gondii is targeted by the immune response and host-protective”. The ‘model’ is a system of ordinary differential equations modeling the dynamics of infected cells and immune cells during an infection of Toxoplasma gondii. 


1. System requirements
 
Python; Tested on version 3.8.17. 
Jupyter Notebook
The following Python libraries are used:
scipy
numpy
matplotlib


2. Installation guide

The TGondiiModel.ipynb file uses only Python and some standard packages. 
.ipynb files are run using Jupyter Notebook.

Python can be downloaded from: https://www.python.org/downloads/.
Python has tutorials for how to install packages: https://packaging.python.org/en/latest/tutorials/installing-packages/.
In Unix/macOS, type: 
python3 -m pip install scipy numpy matplotlib
In Windows, type: 
py -m pip install scipy numpy matplotlib

To install Jupyter Notebook, type:
pip install notebook

The entire installation process can be completed in a few minutes. 

To run Jupyter Notebook, type:
jupyter notebook
Open the TGondiiModel.ipynb file, and you are ready to go. 


3. Demo

Run the first two cells of code by pressing Shift + Enter in each cell. 
The first cell imports the necessary packages. If no errors arise when running this cell, the packages were installed correctly.
The second cell defines the functions that will be used for calculating and plotting the results. 
Next, run the third cell. This will demonstrate the model for the special case cTB=0. A plot of the number of tachyzoite-infected cells, bradyzoite-infected cells (in this case zero), and immune cells normalized by the number of initial healthy cells versus days post infection is displayed. The small tolerance used in our numerical integration is necessary to get the correct behavior for this special case. Confirm that the peaks in the red curve remain at the same value to ensure the integration is being performed correctly. 
Finally, run the fourth cell. This will demonstrate a typical application of the model when all terms are nonzero. A png of the number of tachyzoite-infected cells, bradyzoite-infected cells, and immune cells normalized by the number of initial healthy cells versus days post infection is displayed and saved to your current directory. The expected runtime is one second.  In this particular test, you should see that the immune pressure on both tachyzoites and bradyzoites leads to dampened oscillations in the infected cell number. 


4. Instructions for use

All modeling figures from the paper can be generated by solving the system of ordinary differential equations described by the ‘model’ function and plotting the result for different choices of parameters. The ‘model’ is integrated using solve_ivp, so the first argument of ‘model’ is the list of times, and the second argument is a vector of the unknown quantities we wish to solve for (all normalized by the number of initially healthy cells): 
c: the cumulative number of infected cells
iT: the current number of tachyzoite-infected cells
iB: the current number of bradyzoite-infected cells
z: the current number of immune cells. 
The ten rate parameters of the model are as defined in the paper. Rates should be non-negative. Physically relevant numerical values are also given in the paper, but it is instructive to try adjusting the rates to understand the role of each parameter. 

Only in cases where the cumulative number of tachyzoite and bradyzoite-infected cells is separately desired should ‘modelCTCB’ be integrated instead of ‘model’. 

Various built in functions for generating plots are included. Figure plots can be re-created using the parameters listed in the corresponding caption. 
